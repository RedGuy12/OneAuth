<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>Sign in with email | 1Auth</title>
		<noscript>
			<meta http-equiv="refresh" content="0; url=/old/" />
		</noscript>
		<!-- Google Tag Manager -->
		<script>
			(function (w, d, s, l, i) {
				w[l] = w[l] || [];
				w[l].push({ "gtm.start": new Date().getTime(), event: "gtm.js" });
				var f = d.getElementsByTagName(s)[0],
					j = d.createElement(s),
					dl = l != "dataLayer" ? "&l=" + l : "";
				j.async = true;
				j.src = "https://www.googletagmanager.com/gtm.js?id=" + i + dl;
				f.parentNode.insertBefore(j, f);
			})(window, document, "script", "dataLayer", "GTM-5WN6THR");
		</script>
		<!-- End Google Tag Manager -->
	</head>

	<body style="display: none">
		{{> nav}}
		<main>
			<h1>Login with Email</h1>
			<label for="email-address" id="note">Enter your email to continue</label>
			<form action="" method="POST">
				<input
					id="email-address"
					name="email"
					type="email"
					autocomplete="email"
					required="true"
					placeholder="Email address"
				/>
				<button type="submit" id="submit">Submit</button>
			</form>
		</main>
		<script>
			document.querySelector("form").addEventListener("submit", async (e) => {
				e.preventDefault();
				const email = document.querySelector("input").value;
				await fetch("", {
					headers: {
						"content-type": "application/x-www-form-urlencoded; charset=UTF-8",
					},
					body: "email=" + email,
					method: "POST",
				});
				document.querySelector("form").remove();
				document.querySelector("#note").remove();
				var label = Object.assign(document.createElement("label"), {
					htmlFor: "code",
					id: "note",
					innerText: "Enter the code we sent to you to continue",
				});
				var form = Object.assign(document.createElement("form"), {
					action: "",
					method: "POST",
					autocomplete: "off",
				});
				var code = Object.assign(document.createElement("input"), {
					type: "password",
					name: "code",
					placeholder: "abcde12345",
					autocomplete: "off", // chrome, this is not a password
					required: "true",
					id: "code",
				});
				var hiddenemail = Object.assign(document.createElement("input"), {
					type: "hidden",
					name: "email",
					value: email,
				});
				var submit = Object.assign(document.createElement("input"), {
					type: "submit",
					id: "submit",
				});
				form.appendChild(code);
				form.appendChild(submit);
				form.appendChild(hiddenemail);
				document.querySelector("main").appendChild(label);
				document.querySelector("main").appendChild(form);
			});
		</script>
	</body>
</html>
