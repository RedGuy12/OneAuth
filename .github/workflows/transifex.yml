name: Synchronize with Transifex
on:
    workflow_dispatch:
    schedule:
        - cron: "00 12 * * *"

jobs:
    sync:
        name: Synchronize
        runs-on: ubuntu-latest

        steps:
            - name: Checkout
              if: always()
              uses: actions/checkout@main

            - name: Setup Python
              if: always()
              uses: actions/setup-python@main
              with:
                  python-version: 3.x

            - name: Install
              if: always()
              run: |
                  python -m pip install --upgrade pip 
                  pip install transifex-client

            - name: Setup Transifex
			  if: always()
			  run: tx init --token=${{ secrets.TRANSIFEX }} --force-save --no-interactive --skipsetup

            - name: Push
              run: tx push -ts

            - name: Pull
              run: tx pull --all

            - name: Commit
              if: always()
              uses: stefanzweifel/git-auto-commit-action@master
              with:
                  commit_message: "Synchronize strings with Transifex"
                  branch: main
                  commit_options: "--signoff"
                  commit_user_name: wgytbot
                  commit_user_email: 83586655+wgytbot@users.noreply.github.com
                  commit_author: wgytbot <83586655+wgytbot@users.noreply.github.com>
